// Generated by CoffeeScript 2.7.0
module.exports.run = async function(client, message, args) {
  var guildLanguage, res1, userData;
  // Check if there is a message to send
  if (!args[0]) {
    return client.createMessage(message.channel.id, `:x: Bạn chưa gõ gì để nói với Sim!`);
  }
  userData = client.db.get("chatUses").value()[message.author.id] || 0;
  if (userData > client.config.maxRequestPerUser) {
    return client.createMessage(message.channel.id, `:x: Bạn hành Sim quá trời. Sim nghỉ chơi bạn rồi...`);
  }
  // Try to get guild language
  guildLanguage = client.db.get("serversLanguages").value()[message.channel.guild.id];
  // Make the request
  //res1 = (await client.simsimi.request(args.join(" "), guildLanguage));
    res1 = (await client.simsimi.doPostRequest(args.join(" "), guildLanguage));
  if (!res1) {
    return message.addReaction("😢");
  }
  // Reply
  //client.createMessage(message.channel.id, `${res.message_info.message_reply}`);
  client.createMessage(message.channel.id,{content: `${res1}`, messageReferenceID: message.id});
  // Save uses
  return client.db.set(`chatUses.${message.author.id}`, userData + 1).write();
};

module.exports.help = {
  name: "sim",
  onlyMod: false
};
