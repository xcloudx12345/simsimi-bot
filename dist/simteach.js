// Generated by CoffeeScript 2.7.0
var fetch, simteach;

fetch = require("node-fetch");

simteach = class simteach {
  constructor(token1) {
    this.token = token1;
  }

  request(content, language, token) {
    var params, text, tokenToUse, url;
    tokenToUse = token ? token : this.token;
    url = new URL('https://simsimi.info/api/');
    text = content.split('=>');
    params = {
      teach: 'true',
      ask: text[0],
      ans: text[1],
      lc: language
    };
    url.search = new URLSearchParams(params).toString();
    return new Promise(function(resolve, reject) {
      return fetch(url).then(async function(res) {
        var data;
        data = (await res.json().catch(function() {
          return {};
        }));
        if (!data) {
          console.log((await res.text()));
        }
        return resolve(data);
      });
    });
  }
async doPostRequest(content, language) {

    const form_data = new FormData();

    form_data.append('text', content);
    form_data.append('lc', 'vn');

    let res = await axios.post('https://api.simsimi.info/v1/simtalk', form_data, 
        { headers: form_data.getHeaders() });

    let data = res.data;
    console.log(data);
    return data.message;
} 
};

module.exports = simteach;
